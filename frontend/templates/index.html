
<!DOCTYPE html>
<html>
<head>
  <title>Joey_AI Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v={{ cache_bust }}">
  <!-- Prism.js for syntax highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <!-- markdown-it for markdown rendering -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.2/markdown-it.min.js"></script>
</head>
<body class="theme-joey">
  <!-- LOGO_SRC: {{ url_for('static', filename='img/joey_ai_main_logo.png') }} -->
  <div class="shell">
    <aside class="chat-sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2 class="sidebar-title">CHAT HISTORY</h2>
        <button id="new-conversation-btn" class="new-chat-btn">+ New</button>
      </div>
      
      <!-- Recent Chats Preview Panel -->
      <div class="recent-chats-section">
        <h3 class="recent-chats-title">üìå Recent Chats</h3>
        <div id="recent-chats-preview" class="recent-chats-preview">
          <div class="recent-chat-empty">Loading...</div>
        </div>
      </div>
      
      <input type="text" id="conversation-search" class="chat-search" placeholder="üîç Search chats..." />
      <div id="conversation-list" class="chat-list"></div>
    </aside>
    <header id="topbar" class="header">
      <div class="brand">
        <img class="brand-logo" src="{{ url_for('static', filename='img/joey_ai_main_logo.png') }}" alt="JoeyAI" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';" />
        <span class="brand-text">JoeyAI</span>
        <span class="health-dot" id="health-dot"></span>
      </div>
      <div class="model-controls">
        <div class="control-group">
          <label for="provider-select">Provider:</label>
          <select id="provider-select" class="control-input">
            <option value="ollama">Ollama</option>
            <option value="anthropic">Anthropic</option>
          </select>
        </div>
        <div class="control-group">
          <label for="model-select">Model:</label>
          <div class="model-selector">
            <select id="model-select" class="control-input">
              <option value="">Loading...</option>
            </select>
            <button id="refresh-models-btn" class="refresh-btn" title="Refresh models">‚Üª</button>
          </div>
          <div class="manual-model-container" id="manual-model-container" style="display: none;">
            <input type="text" id="model-manual" class="control-input" placeholder="type model name (e.g., qwen2.5-coder:7b)" style="font-size: 10px; margin-top: 2px;">
            <div class="manual-model-actions">
              <button id="test-model-btn" class="test-btn" title="Test model">Test</button>
              <a href="/v1/models/debug" target="_blank" id="models-debug-link" class="debug-link" title="Models Debug">Debug</a>
            </div>
          </div>
        </div>
        <div class="temperature-control">
          <label for="temperature-slider">Temp:</label>
          <input type="range" id="temperature-slider" min="0" max="1" step="0.1" value="0.7" class="control-slider">
          <span id="temperature-value">0.7</span>
        </div>
      </div>
      <div class="header-right">
        <button id="gear-btn" class="gear-btn" aria-haspopup="true" aria-expanded="false">‚öôÔ∏è</button>
        <div id="gear-menu" class="gear-menu" role="menu" hidden>
          <div class="menu-title">JoeyAI</div>
          <button class="menu-item" data-action="memory">Memory</button>
          <label class="menu-item checkbox">
            <input id="autosave-toggle" type="checkbox" checked />
            Auto-save Chats
          </label>
          <button class="menu-item" data-action="settings">Settings‚Ä¶</button>
          <button class="menu-item" data-action="about">About</button>
        </div>
      </div>
    </header>
    <main class="main">
      <div class="chat-column">
        <div id="hero" class="hero">
          <img id="hero-logo" src="{{ url_for('static', filename='img/joey_ai_main_logo.png') }}" alt="JoeyAI">
        </div>
        <div id="messages" class="messages"></div>
        <form id="composer" class="composer" autocomplete="off">
          <textarea id="composer-input" placeholder="Enter your prompt here‚Ä¶"></textarea>
          <div class="composer-actions">
            <button id="send-btn" type="submit" class="btn primary">Send</button>
            <button id="clearBtn" type="button" class="btn danger">Clear Chat</button>
          </div>
        </form>
      </div>
    </main>
  </div>

  <!-- Right-Side Performance Panel -->
  <div id="perf-panel" class="perf-panel">
    <h3 class="perf-heading">JONS2 SYSTEM</h3>
    <div class="perf-section" id="perf-jons2">
      <div class="perf-item"><label>CPU:</label><span id="cpu-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>MEM:</label><span id="mem-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>GPU:</label><span id="gpu-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>VRAM:</label><span id="vram-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>FAN:</label><span id="fan-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>TEMP CPU:</label><span id="cpu-temp-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>TEMP GPU:</label><span id="gpu-temp-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>POWER:</label><span id="power-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>THROTTLE:</label><span id="throttle-val" class="perf-value">--</span></div>
    </div>

    <h3 class="perf-heading">JOEYAI MODEL</h3>
    <div class="perf-section" id="perf-ai">
      <div class="perf-item"><label>TOKENS/S:</label><span id="tps-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>CTX:</label><span id="ctx-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>MODEL:</label><span id="model-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>LAT:</label><span id="lat-val" class="perf-value">--</span></div>
      <div class="perf-item"><label>STATUS:</label><span id="status-val" class="perf-value">--</span></div>
    </div>
  </div>


  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Memory Modal -->
  <div id="memoryModal" class="modal hidden" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3>Search Memory</h3>
        <button id="memoryModalClose" class="icon-btn" aria-label="Close">√ó</button>
      </div>
      <div class="modal-body">
        <div class="row">
          <input id="memoryQuery" type="text" placeholder="Search memory‚Ä¶" />
          <button id="memorySearchBtn" class="btn">Search</button>
        </div>
        <div id="memoryResults" class="results"></div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal hidden" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3>JoeyAI Settings</h3>
        <button id="settingsModalClose" class="icon-btn" aria-label="Close">√ó</button>
      </div>
      <div class="modal-body">
        <div class="settings-form">
          <div class="setting-item">
            <label for="settings-model">Model:</label>
            <select id="settings-model" class="control-input">
              <option value="">Loading...</option>
            </select>
          </div>
          
          <div class="setting-item">
            <label for="settings-temperature">Temperature:</label>
            <div class="temperature-control">
              <input type="range" id="settings-temperature" min="0" max="1" step="0.01" value="0.7" class="control-slider">
              <span id="settings-temperature-value">0.7</span>
            </div>
          </div>
          
          <div class="setting-item">
            <label>
              <input type="checkbox" id="settings-auto-save" checked>
              Auto-Save Chats
            </label>
          </div>
          
          <div class="setting-item">
            <label for="settings-theme">Theme:</label>
            <select id="settings-theme" class="control-input">
              <option value="dark">Dark</option>
              <option value="light">Light</option>
              <option value="system">System</option>
            </select>
          </div>
          
          <div class="setting-item">
            <label for="settings-memory-limit">Memory Limit (chats):</label>
            <input type="number" id="settings-memory-limit" class="control-input" min="1" max="50" value="10">
          </div>
        </div>
        
        <div class="modal-actions">
          <button id="settings-save-btn" class="btn primary">Save Settings</button>
          <button id="settings-reset-btn" class="btn danger">Reset to Defaults</button>
          <button id="settings-cancel-btn" class="btn">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='scripts.js') }}?v={{ cache_bust }}"></script>
  <script src="{{ url_for('static', filename='keyboard-shortcuts.js') }}?v={{ cache_bust }}"></script>
</body>
</html>
