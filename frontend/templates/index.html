
<!DOCTYPE html>
<html>
<head>
  <title>Joey_AI Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <!-- Prism.js for syntax highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <!-- markdown-it for markdown rendering -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.2/markdown-it.min.js"></script>
</head>
<body class="theme-joey">
  <!-- LOGO_SRC: {{ url_for('static', filename='img/joey_ai_main_logo.png') }} -->
  <div class="shell">
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2>Conversations</h2>
        <button id="new-conversation-btn">New Chat</button>
      </div>
      <input type="text" id="conversation-search" placeholder="Search conversations..." />
      <div id="conversation-list" class="conversation-list"></div>
    </aside>
    <header id="topbar" class="header">
      <div class="brand">
        <img class="brand-logo" src="{{ url_for('static', filename='img/joey_ai_main_logo.png') }}" alt="JoeyAI" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';" />
        <span class="brand-text">JoeyAI</span>
        <span class="health-dot" id="health-dot"></span>
      </div>
      <div class="model-controls">
        <div class="control-group">
          <label for="provider-select">Provider:</label>
          <select id="provider-select" class="control-input">
            <option value="ollama">Ollama</option>
            <option value="anthropic">Anthropic</option>
          </select>
        </div>
        <div class="control-group">
          <label for="model-select">Model:</label>
          <div class="model-selector">
            <select id="model-select" class="control-input">
              <option value="">Loading...</option>
            </select>
            <button id="refresh-models-btn" class="refresh-btn" title="Refresh models">↻</button>
          </div>
          <div class="manual-model-container" id="manual-model-container" style="display: none;">
            <input type="text" id="model-manual" class="control-input" placeholder="type model name (e.g., qwen2.5-coder:7b)" style="font-size: 10px; margin-top: 2px;">
            <div class="manual-model-actions">
              <button id="test-model-btn" class="test-btn" title="Test model">Test</button>
              <a href="/v1/models/debug" target="_blank" id="models-debug-link" class="debug-link" title="Models Debug">Debug</a>
            </div>
          </div>
        </div>
        <div class="temperature-control">
          <label for="temperature-slider">Temp:</label>
          <input type="range" id="temperature-slider" min="0" max="1" step="0.1" value="0.7" class="control-slider">
          <span id="temperature-value">0.7</span>
        </div>
      </div>
      <div class="topbar-actions">
        <button id="test-render-btn" class="btn" style="margin-right: 8px;">Test Render</button>
        <div class="gear" id="gear-dropdown">
          <button class="gear-btn" id="gear-btn">⚙️</button>
          <div class="gear-menu hidden" id="gear-menu">
            <div class="gear-item" data-action="memory">Memory</div>
            <div class="gear-item toggle-item">
              <label>
                <input type="checkbox" id="autosave-toggle" checked>
                Auto-save Chats
              </label>
            </div>
            <div class="gear-item" data-action="settings">Settings…</div>
            <div class="gear-item" data-action="about">About</div>
          </div>
        </div>
      </div>
    </header>
    <main class="main">
      <div class="chat-column">
        <div id="hero" class="hero">
          <img id="hero-logo" src="{{ url_for('static', filename='img/joey_ai_main_logo.png') }}" alt="JoeyAI">
        </div>
        <div id="messages" class="messages"></div>
        <form id="composer" class="composer" autocomplete="off">
          <textarea id="composer-input" placeholder="Enter your prompt here…"></textarea>
          <div class="composer-actions">
            <button id="send-btn" type="submit" class="btn primary">Send</button>
            <button id="advancedBtn" type="button" class="btn">Advanced</button>
            <button id="clearBtn" type="button" class="btn danger">Clear Chat</button>
            <button id="deepBtn" type="button" class="btn pill">Deep Reasoning</button>
            <button id="auditBtn" type="button" class="btn pill">Code Audit</button>
            <button id="edgeBtn" type="button" class="btn pill">Edge Cases</button>
          </div>
        </form>
      </div>
    </main>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Memory Modal -->
  <div id="memoryModal" class="modal hidden" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3>Search Memory</h3>
        <button id="memoryModalClose" class="icon-btn" aria-label="Close">×</button>
      </div>
      <div class="modal-body">
        <div class="row">
          <input id="memoryQuery" type="text" placeholder="Search memory…" />
          <button id="memorySearchBtn" class="btn">Search</button>
        </div>
        <div id="memoryResults" class="results"></div>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='scripts.js') }}"></script>
  <script src="{{ url_for('static', filename='keyboard-shortcuts.js') }}"></script>
</body>
</html>
